-- After connecting to the SQL-server using terminal and created the database

-- Create 12 tables under the database
CREATE TABLE 202101_divvy_tripdata (
            `ride_id` CHAR(16) NOT NULL,
            `rideable_type` TINYTEXT NULL,
            `started_at` DATETIME NULL,
            `ended_at` DATETIME NULL,
            `start_station_name` TINYTEXT NULL,
            `start_station_id` CHAR(12) NULL,
            `end_station_name` TINYTEXT NULL,
            `end_station_id` CHAR(12) NULL,
            `start_lat` DOUBLE NULL,
            `start_lng` DOUBLE NULL,
            `end_lat` DOUBLE NULL,
            `end_lng` DOUBLE NULL,
            `member_casual` TEXT(6) NULL,
            PRIMARY KEY(`ride_id`));

CREATE TABLE 202102_divvy_tripdata (
            `ride_id` CHAR(16) NOT NULL,
            `rideable_type` TINYTEXT NULL,
            `started_at` DATETIME NULL,
            `ended_at` DATETIME NULL,
            `start_station_name` TINYTEXT NULL,
            `start_station_id` CHAR(12) NULL,
            `end_station_name` TINYTEXT NULL,
            `end_station_id` CHAR(12) NULL,
            `start_lat` DOUBLE NULL,
            `start_lng` DOUBLE NULL,
            `end_lat` DOUBLE NULL,
            `end_lng` DOUBLE NULL,
            `member_casual` TEXT(6) NULL,
            PRIMARY KEY(`ride_id`));

CREATE TABLE 202103_divvy_tripdata (
            `ride_id` CHAR(16) NOT NULL,
            `rideable_type` TINYTEXT NULL,
            `started_at` DATETIME NULL,
            `ended_at` DATETIME NULL,
            `start_station_name` TINYTEXT NULL,
            `start_station_id` CHAR(12) NULL,
            `end_station_name` TINYTEXT NULL,
            `end_station_id` CHAR(12) NULL,
            `start_lat` DOUBLE NULL,
            `start_lng` DOUBLE NULL,
            `end_lat` DOUBLE NULL,
            `end_lng` DOUBLE NULL,
            `member_casual` TEXT(6) NULL,
            PRIMARY KEY(`ride_id`));

CREATE TABLE 202104_divvy_tripdata (
            `ride_id` CHAR(16) NOT NULL,
            `rideable_type` TINYTEXT NULL,
            `started_at` DATETIME NULL,
            `ended_at` DATETIME NULL,
            `start_station_name` TINYTEXT NULL,
            `start_station_id` CHAR(12) NULL,
            `end_station_name` TINYTEXT NULL,
            `end_station_id` CHAR(12) NULL,
            `start_lat` DOUBLE NULL,
            `start_lng` DOUBLE NULL,
            `end_lat` DOUBLE NULL,
            `end_lng` DOUBLE NULL,
            `member_casual` TEXT(6) NULL,
            PRIMARY KEY(`ride_id`));

CREATE TABLE 202105_divvy_tripdata (
            `ride_id` CHAR(16) NOT NULL,
            `rideable_type` TINYTEXT NULL,
            `started_at` DATETIME NULL,
            `ended_at` DATETIME NULL,
            `start_station_name` TINYTEXT NULL,
            `start_station_id` CHAR(12) NULL,
            `end_station_name` TINYTEXT NULL,
            `end_station_id` CHAR(12) NULL,
            `start_lat` DOUBLE NULL,
            `start_lng` DOUBLE NULL,
            `end_lat` DOUBLE NULL,
            `end_lng` DOUBLE NULL,
            `member_casual` TEXT(6) NULL,
            PRIMARY KEY(`ride_id`));

CREATE TABLE 202106_divvy_tripdata (
            `ride_id` CHAR(16) NOT NULL,
            `rideable_type` TINYTEXT NULL,
            `started_at` DATETIME NULL,
            `ended_at` DATETIME NULL,
            `start_station_name` TINYTEXT NULL,
            `start_station_id` CHAR(12) NULL,
            `end_station_name` TINYTEXT NULL,
            `end_station_id` CHAR(12) NULL,
            `start_lat` DOUBLE NULL,
            `start_lng` DOUBLE NULL,
            `end_lat` DOUBLE NULL,
            `end_lng` DOUBLE NULL,
            `member_casual` TEXT(6) NULL,
            PRIMARY KEY(`ride_id`));

CREATE TABLE 202107_divvy_tripdata (
            `ride_id` CHAR(16) NOT NULL,
            `rideable_type` TINYTEXT NULL,
            `started_at` DATETIME NULL,
            `ended_at` DATETIME NULL,
            `start_station_name` TINYTEXT NULL,
            `start_station_id` CHAR(12) NULL,
            `end_station_name` TINYTEXT NULL,
            `end_station_id` CHAR(12) NULL,
            `start_lat` DOUBLE NULL,
            `start_lng` DOUBLE NULL,
            `end_lat` DOUBLE NULL,
            `end_lng` DOUBLE NULL,
            `member_casual` TEXT(6) NULL,
            PRIMARY KEY(`ride_id`));

CREATE TABLE 202108_divvy_tripdata (
            `ride_id` CHAR(16) NOT NULL,
            `rideable_type` TINYTEXT NULL,
            `started_at` DATETIME NULL,
            `ended_at` DATETIME NULL,
            `start_station_name` TINYTEXT NULL,
            `start_station_id` CHAR(12) NULL,
            `end_station_name` TINYTEXT NULL,
            `end_station_id` CHAR(12) NULL,
            `start_lat` DOUBLE NULL,
            `start_lng` DOUBLE NULL,
            `end_lat` DOUBLE NULL,
            `end_lng` DOUBLE NULL,
            `member_casual` TEXT(6) NULL,
            PRIMARY KEY(`ride_id`));

CREATE TABLE 202109_divvy_tripdata (
            `ride_id` CHAR(16) NOT NULL,
            `rideable_type` TINYTEXT NULL,
            `started_at` DATETIME NULL,
            `ended_at` DATETIME NULL,
            `start_station_name` TINYTEXT NULL,
            `start_station_id` CHAR(12) NULL,
            `end_station_name` TINYTEXT NULL,
            `end_station_id` CHAR(12) NULL,
            `start_lat` DOUBLE NULL,
            `start_lng` DOUBLE NULL,
            `end_lat` DOUBLE NULL,
            `end_lng` DOUBLE NULL,
            `member_casual` TEXT(6) NULL,
            PRIMARY KEY(`ride_id`));

CREATE TABLE 202110_divvy_tripdata (
            `ride_id` CHAR(16) NOT NULL,
            `rideable_type` TINYTEXT NULL,
            `started_at` DATETIME NULL,
            `ended_at` DATETIME NULL,
            `start_station_name` TINYTEXT NULL,
            `start_station_id` CHAR(12) NULL,
            `end_station_name` TINYTEXT NULL,
            `end_station_id` CHAR(12) NULL,
            `start_lat` DOUBLE NULL,
            `start_lng` DOUBLE NULL,
            `end_lat` DOUBLE NULL,
            `end_lng` DOUBLE NULL,
            `member_casual` TEXT(6) NULL,
            PRIMARY KEY(`ride_id`));                                                            

CREATE TABLE 202111_divvy_tripdata (
            `ride_id` CHAR(16) NOT NULL,
            `rideable_type` TINYTEXT NULL,
            `started_at` DATETIME NULL,
            `ended_at` DATETIME NULL,
            `start_station_name` TINYTEXT NULL,
            `start_station_id` CHAR(12) NULL,
            `end_station_name` TINYTEXT NULL,
            `end_station_id` CHAR(12) NULL,
            `start_lat` DOUBLE NULL,
            `start_lng` DOUBLE NULL,
            `end_lat` DOUBLE NULL,
            `end_lng` DOUBLE NULL,
            `member_casual` TEXT(6) NULL,
            PRIMARY KEY(`ride_id`));            

CREATE TABLE 202112_divvy_tripdata (
            `ride_id` CHAR(16) NOT NULL,
            `rideable_type` TINYTEXT NULL,
            `started_at` DATETIME NULL,
            `ended_at` DATETIME NULL,
            `start_station_name` TINYTEXT NULL,
            `start_station_id` CHAR(12) NULL,
            `end_station_name` TINYTEXT NULL,
            `end_station_id` CHAR(12) NULL,
            `start_lat` DOUBLE NULL,
            `start_lng` DOUBLE NULL,
            `end_lat` DOUBLE NULL,
            `end_lng` DOUBLE NULL,
            `member_casual` TEXT(6) NULL,
            PRIMARY KEY(`ride_id`));

-- Import 12 `.csv` files to its respective table (LOAD DATA LOCAL INFILE '/path/to/your/file/202101-divvy-tripdata.csv')
LOAD DATA LOCAL INFILE '/home/marcondes/WorkspaceCaio/Curso-analise-de-dados/Data-Analysis-Projects/202101-divvy-tripdata.csv'
INTO TABLE 202101_divvy_tripdata 
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS (`ride_id`, `rideable_type`, `started_at`, `ended_at`, `start_station_name`, `start_station_id`, `end_station_name`, `end_station_id`, `start_lat`, `start_lng`, `end_lat`, `end_lng`, `member_casual`);

LOAD DATA LOCAL INFILE '/home/marcondes/WorkspaceCaio/Curso-analise-de-dados/Data-Analysis-Projects/Bike-Sharing/sheets/202102-divvy-tripdata.csv'
INTO TABLE 202102_divvy_tripdata 
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS (`ride_id`, `rideable_type`, `started_at`, `ended_at`, `start_station_name`, `start_station_id`, `end_station_name`, `end_station_id`, `start_lat`, `start_lng`, `end_lat`, `end_lng`, `member_casual`);

LOAD DATA LOCAL INFILE '/home/marcondes/WorkspaceCaio/Curso-analise-de-dados/Data-Analysis-Projects/Bike-Sharing/sheets/202103-divvy-tripdata.csv'
INTO TABLE 202103_divvy_tripdata 
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS (`ride_id`, `rideable_type`, `started_at`, `ended_at`, `start_station_name`, `start_station_id`, `end_station_name`, `end_station_id`, `start_lat`, `start_lng`, `end_lat`, `end_lng`, `member_casual`);

LOAD DATA LOCAL INFILE '/home/marcondes/WorkspaceCaio/Curso-analise-de-dados/Data-Analysis-Projects/Bike-Sharing/sheets/202104-divvy-tripdata.csv'
INTO TABLE 202104_divvy_tripdata 
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS (`ride_id`, `rideable_type`, `started_at`, `ended_at`, `start_station_name`, `start_station_id`, `end_station_name`, `end_station_id`, `start_lat`, `start_lng`, `end_lat`, `end_lng`, `member_casual`);

LOAD DATA LOCAL INFILE '/home/marcondes/WorkspaceCaio/Curso-analise-de-dados/Data-Analysis-Projects/Bike-Sharing/sheets/202105-divvy-tripdata.csv'
INTO TABLE 202105_divvy_tripdata 
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS (`ride_id`, `rideable_type`, `started_at`, `ended_at`, `start_station_name`, `start_station_id`, `end_station_name`, `end_station_id`, `start_lat`, `start_lng`, `end_lat`, `end_lng`, `member_casual`);

LOAD DATA LOCAL INFILE '/home/marcondes/WorkspaceCaio/Curso-analise-de-dados/Data-Analysis-Projects/Bike-Sharing/sheets/202106-divvy-tripdata.csv'
INTO TABLE 202106_divvy_tripdata 
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS (`ride_id`, `rideable_type`, `started_at`, `ended_at`, `start_station_name`, `start_station_id`, `end_station_name`, `end_station_id`, `start_lat`, `start_lng`, `end_lat`, `end_lng`, `member_casual`);

LOAD DATA LOCAL INFILE '/home/marcondes/WorkspaceCaio/Curso-analise-de-dados/Data-Analysis-Projects/Bike-Sharing/sheets/202107-divvy-tripdata.csv'
INTO TABLE 202107_divvy_tripdata 
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS (`ride_id`, `rideable_type`, `started_at`, `ended_at`, `start_station_name`, `start_station_id`, `end_station_name`, `end_station_id`, `start_lat`, `start_lng`, `end_lat`, `end_lng`, `member_casual`);

LOAD DATA LOCAL INFILE '/home/marcondes/WorkspaceCaio/Curso-analise-de-dados/Data-Analysis-Projects/Bike-Sharing/sheets/202108-divvy-tripdata.csv'
INTO TABLE 202108_divvy_tripdata 
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS (`ride_id`, `rideable_type`, `started_at`, `ended_at`, `start_station_name`, `start_station_id`, `end_station_name`, `end_station_id`, `start_lat`, `start_lng`, `end_lat`, `end_lng`, `member_casual`);

LOAD DATA LOCAL INFILE '/home/marcondes/WorkspaceCaio/Curso-analise-de-dados/Data-Analysis-Projects/Bike-Sharing/sheets/202109-divvy-tripdata.csv'
INTO TABLE 202109_divvy_tripdata 
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS (`ride_id`, `rideable_type`, `started_at`, `ended_at`, `start_station_name`, `start_station_id`, `end_station_name`, `end_station_id`, `start_lat`, `start_lng`, `end_lat`, `end_lng`, `member_casual`);

LOAD DATA LOCAL INFILE '/home/marcondes/WorkspaceCaio/Curso-analise-de-dados/Data-Analysis-Projects/Bike-Sharing/sheets/202110-divvy-tripdata.csv'
INTO TABLE 202110_divvy_tripdata 
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS (`ride_id`, `rideable_type`, `started_at`, `ended_at`, `start_station_name`, `start_station_id`, `end_station_name`, `end_station_id`, `start_lat`, `start_lng`, `end_lat`, `end_lng`, `member_casual`);

LOAD DATA LOCAL INFILE '/home/marcondes/WorkspaceCaio/Curso-analise-de-dados/Data-Analysis-Projects/Bike-Sharing/sheets/202111-divvy-tripdata.csv'
INTO TABLE 202111_divvy_tripdata 
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS (`ride_id`, `rideable_type`, `started_at`, `ended_at`, `start_station_name`, `start_station_id`, `end_station_name`, `end_station_id`, `start_lat`, `start_lng`, `end_lat`, `end_lng`, `member_casual`);

LOAD DATA LOCAL INFILE '/home/marcondes/WorkspaceCaio/Curso-analise-de-dados/Data-Analysis-Projects/Bike-Sharing/sheets/202112-divvy-tripdata.csv'
INTO TABLE 202112_divvy_tripdata 
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"' 
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS (`ride_id`, `rideable_type`, `started_at`, `ended_at`, `start_station_name`, `start_station_id`, `end_station_name`, `end_station_id`, `start_lat`, `start_lng`, `end_lat`, `end_lng`, `member_casual`);

-- Combining all tables into one
CREATE TABLE `2021_divvy_tripdata` AS (
   SELECT * FROM `202101_divvy_tripdata`
   UNION ALL
   SELECT * FROM `202102_divvy_tripdata`
   UNION ALL
   SELECT * FROM `202103_divvy_tripdata`
   UNION ALL
   SELECT * FROM `202104_divvy_tripdata`
   UNION ALL
   SELECT * FROM `202105_divvy_tripdata`
   UNION ALL
   SELECT * FROM `202106_divvy_tripdata`
   UNION ALL
   SELECT * FROM `202107_divvy_tripdata`
   UNION ALL
   SELECT * FROM `202108_divvy_tripdata`
   UNION ALL
   SELECT * FROM `202109_divvy_tripdata`
   UNION ALL
   SELECT * FROM `202110_divvy_tripdata`
   UNION ALL
   SELECT * FROM `202111_divvy_tripdata`
   UNION ALL
   SELECT * FROM `202112_divvy_tripdata`
);

-- Delete all 12 tables
DROP TABLES 202101_divvy_tripdata, 202102_divvy_tripdata, 202103_divvy_tripdata, 202104_divvy_tripdata, 202105_divvy_tripdata, 202106_divvy_tripdata, 202107_divvy_tripdata, 202108_divvy_tripdata, 202109_divvy_tripdata, 202110_divvy_tripdata, 202111_divvy_tripdata, 202112_divvy_tripdata;